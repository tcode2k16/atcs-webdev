<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href='../res/favicon.ico' rel='icon' type='image/x-icon'/>
  <title>My CTF Cheatsheet</title>
  <link rel="stylesheet" href="../res/dark.css">
  <style>
    blockquote {
      border-left: 4px solid rgba(0, 150, 191, .67);
      margin: 1.5em 0;
      padding: .5em 1em;
      font-style: italic;
      margin-block-start: 0.5em;
      margin-block-end: 0.5em;
    }

    .index-parallax {
      position: absolute;
      top: 0;
      display: none;
    }

    body {
      overflow-x: hidden;
    }

    @media (min-width: 1200px) {
      .index-parallax {
        position: absolute;
        top: 0;
        display: block;
        width: 100vw;
      }

      .index-parallax__shape {
        position: absolute;
        top: 0;
      }

      .index-parallax__circle {
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: #65D0CE;
      }

      .index-parallax__circle-red {
        /* background: transparent; */
        /* border: 1px solid #ee0000; */
        background: #ffbe85;
      }
    }
  </style>
</head>

<body>
  <h1>My CTF Cheatsheet</h1>
  <hr>
  <div>
    <img src="./res/header.png" alt="">
    <blockquote>Here's a cool image generated by a convolutional neural network from WPICTF 2019</blockquote>
  </div>
  <div>
    <hr>
    <h2>Table of content</h2>
    <ul>
      <li><a href="#general">general</a></li>
      <li><a href="#crypto">crypto</a>
        <ul>
          <li><a href="#old-ciphers">old ciphers</a></li>
          <li><a href="#checklist">checklist</a></li>
          <li><a href="#finite-field-stuff">finite field stuff</a></li>
          <li><a href="#rsa">rsa</a></li>
        </ul>
      </li>
      <li><a href="#misc">misc</a>
        <ul>
          <li><a href="#checklist-1">checklist</a></li>
        </ul>
      </li>
      <li><a href="#stegno">stegno</a></li>
      <li><a href="#pwn">pwn</a>
        <ul>
          <li><a href="#null-termination">Null Termination</a></li>
          <li><a href="#bypass-stack-canary">bypass stack canary</a></li>
          <li><a href="#heap">heap</a></li>
          <li><a href="#tip">tip</a></li>
        </ul>
      </li>
      <li><a href="#rev">rev</a></li>
      <li><a href="#web">web</a></li>
      <li><a href="#bash">bash</a>
        <ul>
          <li><a href="#how-to-spawn-a-reverse-shell">How to spawn a reverse shell</a></li>
          <li><a href="#how-to-convert-binary-to-hex">How to convert binary to hex</a></li>
          <li><a href="#how-to-break-bash-commands-apart">How to break bash commands apart</a></li>
          <li><a href="#bypass-filter">bypass filter</a></li>
          <li><a href="#checklist-2">checklist</a></li>
        </ul>
      </li>
    </ul>
    <h2 id="general">general</h2>
    <ul>
      <li><a href="https://gchq.github.io/CyberChef/">CyberChef</a></li>
      <li><a href="https://kt.gy/tools.html#conv/">kt.gy</a></li>
      <li><a href="https://github.com/OpenToAllCTF/Tips">OTA tips</a></li>
      <li><a href="https://github.com/JohnHammond/ctf-katana">ctf-katana</a></li>
    </ul>
    <h2 id="crypto">crypto</h2>
    <ul>
      <li><a href="https://www.alpertron.com.ar/ECM.HTM">Integer factorization calculator</a></li>
    </ul>
    <h3 id="old-ciphers">old ciphers</h3>
    <ul>
      <li><a href="https://www.dcode.fr/bifid-cipher">bifid cipher</a></li>
      <li><a href="https://www.dcode.fr/pigpen-cipher">pigpen cipher</a></li>
      <li><a href="http://www.dcode.fr/vigenere-cipher">vigenere cipher</a></li>
      <li><a href="https://gchq.github.io/CyberChef/">rot13</a></li>
      <li><a href="https://www.guballa.de/substitution-solver">substitution cipher</a></li>
    </ul>
    <h3 id="checklist">checklist</h3>
    <ul>
      <li>if get binary data, try xor</li>
      <li>LCG: try <a href="https://teamrocketist.github.io/2019/03/31/Crypto-VolgaCtf2019-LG/">this</a> from
        VolgaCtf2019
      </li>
      <li>LFSR: try <a href="https://ctftime.org/writeup/14196">this</a></li>
    </ul>
    <h3 id="finite-field-stuff">finite field stuff</h3>
    <ul>
      <li>if you know the roots for polynomial mod n, you can find the roots for the polynomial mod n+1 (check <a
          href="https://amritabi0s.wordpress.com/2019/03/18/confidence-teaser-ctf-crypto-writeups/">this</a>)</li>
    </ul>
    <h3 id="rsa">rsa</h3>
    <ul>
      <li>do you know how p and q are generated? try <a
          href="https://amritabi0s.wordpress.com/2019/03/18/confidence-teaser-ctf-crypto-writeups/">this</a></li>
      <li><a href="https://teamrocketist.github.io/2019/04/01/Crypto-VolgaCtf2019-Blind/">use RSAâ€™s malleability
          property
          to forge a signature</a> (only works for unpadded message)</li>
      <li><a href="http://duksctf.github.io/2019/04/13/PlaidCTF2019-rusad.html">recover private key from iPmQ and
          iQmP</a>
      </li>
    </ul>
    <h2 id="misc">misc</h2>
    <h3 id="checklist-1">checklist</h3>
    <ul>
      <li>is it an esolang</li>
      <li>corrupted header</li>
      <li>base encoding - base64, base62, base85, base91, etc</li>
      <li>zero-width char/zero font size</li>
      <li>if it is a zip, try <code>john --wordlist=rockyou.txt --rules hash</code></li>
      <li>if have to fit regular expression, try <code>rstr.xeger</code></li>
    </ul>
    <h2 id="stegno">stegno</h2>
    <ul>
      <li>use <code>montage -mode concatenate</code> to concat images</li>
      <li>for lsb try <code>zsteg -a</code></li>
    </ul>
    <h2 id="pwn">pwn</h2>
    <h3 id="null-termination">Null Termination</h3>
    <h4 id="do-not-read-past-first-null-byte">Do NOT read past first null byte</h4>
    <ul>
      <li>strcpy()</li>
      <li>strncpy()</li>
    </ul>
    <h4 id="do-read-past-first-null-byte">Do read past first null byte</h4>
    <ul>
      <li>read()</li>
      <li>gets()</li>
      <li>fgets()</li>
      <li>memcpy()</li>
      <li>scanf()</li>
    </ul>
    <h4 id="does-copy-the-terminating-nullbyte-from-src-to-dst">Does copy the terminating nullbyte from src to dst</h4>
    <ul>
      <li>strcpy()</li>
    </ul>
    <blockquote>
      <p>from ota tips</p>
    </blockquote>
    <h3 id="bypass-stack-canary">bypass stack canary</h3>
    <p>provide the characters - or +, and the <code>scanf</code> will <em>not</em> change the value of the variable</p>
    <blockquote>
      <p>from <a href="https://lordidiot.github.io/2019-02-03/nullcon-hackim-ctf-2019/#babypwn">this</a></p>
    </blockquote>
    <h3 id="heap">heap</h3>
    <ul>
      <li>fastbin (size &lt; 144 bytes or 0x90 bytes) - LIFO</li>
      <li>small bin (size &lt; 1024 bytes or 0x400 bytes) - FIFO</li>
    </ul>
    <h3 id="tip">tip</h3>
    <ul>
      <li>You can't LD_PRELOAD a setuid binary but you CAN LD_PRELOAD an executable-only binary</li>
      <li>vsyscall have constant addr even when PIE is enabled</li>
      <li><code>constgrep</code> to find syscall no.</li>
    </ul>
    <h2 id="rev">rev</h2>
    <ul>
      <li>use r2pipe to brute force key <a
          href="https://web.archive.org/web/20190307022303/https://github.com/acdwas/ctf/blob/master/2019/TAMUctf/rev/Obfuscaxor/obfuscaxor.py">this</a>
      </li>
      <li>is it 6502 assembly?</li>
      <li>angr with limitation. read <a
          href="https://github.com/elklepo/pwn/blob/master/PlaidCTF_2019/i_can_count/exploit.py">this</a></li>
    </ul>
    <h2 id="web">web</h2>
    <ul>
      <li>try to trigger error</li>
      <li>search existing bugs on github issues and CVEs</li>
      <li>phar files</li>
      <li>check http headers</li>
      <li>check sql (<code>' or 1=1 --</code>) and nosql (<code>{"$ne": "null"}</code>) injection</li>
      <li>try <code>aws s3 ls s3://</code></li>
      <li>check <code>robots.txt</code>, <code>.env</code>, <code>.git</code></li>
      <li><a href="https://medium.com/@anassboulbalitkd/b00t2root-19-ctf-writeup-web-219-easyphp-f869e7259d9c">php hash
          tricks</a></li>
    </ul>
    <h2 id="bash">bash</h2>
    <h3 id="how-to-spawn-a-reverse-shell">How to spawn a reverse shell</h3>
    <ul>
      <li><a
          href="https://web.archive.org/web/20190215143410/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse
          Shell Cheat Sheet</a></li>
      <li><a href="https://github.com/lukechilds/reverse-shell">Reverse Shell as a Service</a></li>
    </ul>
    <h3 id="how-to-convert-binary-to-hex">How to convert binary to hex</h3>
    <ul>
      <li><code>od -vtx1</code></li>
      <li><code>xxd</code></li>
      <li><code>hexdump</code></li>
    </ul>
    <h3 id="how-to-break-bash-commands-apart">How to break bash commands apart</h3>
    <ul>
      <li><code>;</code></li>
      <li><code>#</code></li>
      <li><code>${IFS}</code></li>
    </ul>
    <h3 id="bypass-filter">bypass filter</h3>
    <ul>
      <li><code>/**/</code> matches all folders</li>
      <li><code>?</code> matches any character</li>
      <li><code>$0</code> refers to the parent program</li>
      <li><code>/usr/bin/x86_64</code> spawns a shell</li>
      <li><code>sh /FILE</code> can read file</li>
    </ul>
    <h3 id="checklist-2">checklist</h3>
    <ul>
      <li>try <a href="https://gtfobins.github.io">GTFOBins</a></li>
      <li>check out <a href="https://docstore.mik.ua/orelly/unix2.1/upt/ch08_19.htm">this</a></li>
    </ul>
    <br>
    <hr>
    <footer style="text-align: right;">
      Created by <a href="https://tcode2k16.github.io/blog/about/">Alan Chang</a>
    </footer>
    <div class="index-parallax">

      <div class="index-parallax__shape js-parallax" data-rellax-speed="-1.2" style="margin:210vh 0 0 -30vw;">
        <svg width="298px" height="370px" viewBox="0 0 298 370" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <defs>
            <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
              <stop stop-color="#F7FAFC" offset="0%" />
              <stop stop-color="#DFEBF7" offset="100%" />
            </linearGradient>
          </defs>
          <path
            d="M145.918 370C229.911 370 298 287.173 298 185S268.967 0 145.918 0C22.869 0 52.589 128 18.884 185c-62.461 105.633 43.041 185 127.034 185z"
            fill="url(#a)" fill-rule="evenodd" />
        </svg>
      </div>

      <div class="index-parallax__shape js-parallax" data-rellax-speed="-1" style="margin:217vh 0 0 -32vw;">
        <svg width="365px" height="372px" viewBox="0 0 365 372" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <path
            d="M178.746 371C281.059 371 364 288.173 364 186S328.634 1 178.746 1C28.857 1 65.06 129 24.004 186c-76.087 105.633 52.429 185 154.742 185z"
            stroke="#FDDF46" fill="none" fill-rule="evenodd" />
        </svg>
      </div>

      <div class="index-parallax__shape js-parallax" data-rellax-speed="1" style="margin:258vh 0 0 -16vw;">
        <div class="index-parallax__circle"></div>
      </div>

      <div class="index-parallax__shape js-parallax" data-rellax-speed="-0.5" style="margin:397vh 0 0 60vw;">
        <svg width="298px" height="370px" viewBox="0 0 298 370" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <defs>
            <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
              <stop stop-color="#F7FAFC" offset="0%" />
              <stop stop-color="#DFEBF7" offset="100%" />
            </linearGradient>
          </defs>
          <path
            d="M145.918 370C229.911 370 298 287.173 298 185S268.967 0 145.918 0C22.869 0 52.589 128 18.884 185c-62.461 105.633 43.041 185 127.034 185z"
            fill="url(#a)" fill-rule="evenodd" />
        </svg>
      </div>

      <div class="index-parallax__shape js-parallax" data-rellax-speed="-1.5" style="margin:378vh 0 0 60vw;">
        <svg width="365px" height="372px" viewBox="0 0 365 372" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <path
            d="M178.746 371C281.059 371 364 288.173 364 186S328.634 1 178.746 1C28.857 1 65.06 129 24.004 186c-76.087 105.633 52.429 185 154.742 185z"
            stroke="#65D0CE" fill="none" fill-rule="evenodd" />
        </svg>
      </div>

      <div class="index-parallax__shape js-parallax" data-rellax-speed="1.5" style="margin:494vh 0 0 60vw;">
        <div class="index-parallax__circle index-parallax__circle-red"></div>
      </div>

    </div>
  </div>
  <script src="./res/rellax.min.js"></script>
  <script>
    // Accepts any class name
    var rellax = new Rellax('.js-parallax');
  </script>
</body>

</html>